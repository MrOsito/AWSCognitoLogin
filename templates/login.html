<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cognito Login</title>
  <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1487.0.min.js"></script>
</head>
<body>
  <h2>Login</h2>
  <form id="loginForm">
    <label for="state">Select your state:</label>
    <select id="state" name="state" required>
      <option value="NSW-">NSW</option>
      <option value="VIC-">VIC</option>
      <option value="QLD-">QLD</option>
      <option value="SA-">SA</option>
      <option value="WA-">WA</option>
      <option value="TAS-">TAS</option>
      <option value="ACT-">ACT</option>
      <option value="NT-">NT</option>
    </select><br><br>

    <label for="membershipNumber">Membership Number:</label>
    <input type="text" id="membershipNumber" name="membershipNumber" required><br><br>

    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required><br><br>

    <button type="submit">Login</button>
  </form>

  <div id="message" style="margin-top:20px;color:red;"></div>

  <script>
    AWS.config.region = 'ap-southeast-2'; // e.g. Sydney
    const cognitoClientId = 'YOUR_APP_CLIENT_ID'; // Replace this
    const userPoolId = 'ap-southeast-2_XXXXXXX'; // Replace this

    document.getElementById("loginForm").addEventListener("submit", async function (e) {
      e.preventDefault();

      const state = document.getElementById("state").value;
      const membershipNumber = document.getElementById("membershipNumber").value;
      const password = document.getElementById("password").value;
      const username = state + membershipNumber;

      const cognito = new AWS.CognitoIdentityServiceProvider();

      const params = {
        AuthFlow: 'USER_PASSWORD_AUTH',
        ClientId: cognitoClientId,
        AuthParameters: {
          USERNAME: username,
          PASSWORD: password
        }
      };

      try {
        const result = await cognito.initiateAuth(params).promise();
        document.getElementById("message").style.color = "green";
        document.getElementById("message").innerText = "Login successful!";
        console.log("Access Token:", result.AuthenticationResult.AccessToken);
        // You can redirect or save token to localStorage/sessionStorage if needed
      } catch (err) {
        document.getElementById("message").innerText = "Login failed: " + err.message;
        console.error("Login error:", err);
      }
    });
  </script>
</body>
</html>
